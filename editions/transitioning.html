<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Transitioning your code to a new edition - The Rust Edition Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="_FontAwesome/css/font-awesome.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="introduction.html">Introduction</a></li><li><a href="editions/index.html"><strong aria-hidden="true">1.</strong> What are Editions?</a></li><li><ol class="section"><li><a href="editions/transitioning.html" class="active"><strong aria-hidden="true">1.1.</strong> Transitioning your code to a new edition</a></li></ol></li><li><a href="2015/index.html"><strong aria-hidden="true">2.</strong> Rust 2015</a></li><li><a href="2018/index.html"><strong aria-hidden="true">3.</strong> Rust 2018</a></li><li><ol class="section"><li><a href="2018/transitioning/to-rust-2018.html"><strong aria-hidden="true">3.1.</strong> Transitioning to Rust 2018</a></li><li><ol class="section"><li><a href="2018/transitioning/traits/index.html"><strong aria-hidden="true">3.1.1.</strong> Trait system</a></li><li><ol class="section"><li><a href="2018/transitioning/traits/impl-trait.html"><strong aria-hidden="true">3.1.1.1.</strong> impl Trait</a></li><li><a href="2018/transitioning/traits/dyn-trait.html"><strong aria-hidden="true">3.1.1.2.</strong> dyn Trait</a></li></ol></li><li><a href="2018/transitioning/modules/index.html"><strong aria-hidden="true">3.1.2.</strong> Module system</a></li><li><ol class="section"><li><a href="2018/transitioning/modules/path-clarity.html"><strong aria-hidden="true">3.1.2.1.</strong> Path clarity</a></li><li><a href="2018/transitioning/modules/macros.html"><strong aria-hidden="true">3.1.2.2.</strong> Macro changes</a></li></ol></li><li><a href="2018/transitioning/concurrency/index.html"><strong aria-hidden="true">3.1.3.</strong> Concurrency additions</a></li><li><ol class="section"><li><a href="2018/transitioning/concurrency/async-await.html"><strong aria-hidden="true">3.1.3.1.</strong> async/await</a></li></ol></li><li><a href="2018/transitioning/ownership-and-lifetimes/index.html"><strong aria-hidden="true">3.1.4.</strong> Ownership and lifetimes</a></li><li><ol class="section"><li><a href="2018/transitioning/ownership-and-lifetimes/anonymous-lifetime.html"><strong aria-hidden="true">3.1.4.1.</strong> '_, the anonymous lifetime</a></li><li><a href="2018/transitioning/ownership-and-lifetimes/in-band-lifetimes.html"><strong aria-hidden="true">3.1.4.2.</strong> In-band lifetimes</a></li><li><a href="2018/transitioning/ownership-and-lifetimes/default-match-bindings.html"><strong aria-hidden="true">3.1.4.3.</strong> Default match bindings</a></li><li><a href="2018/transitioning/ownership-and-lifetimes/lifetime-elision-in-impl.html"><strong aria-hidden="true">3.1.4.4.</strong> Lifetime elision in impl</a></li><li><a href="2018/transitioning/ownership-and-lifetimes/struct-inference.html"><strong aria-hidden="true">3.1.4.5.</strong> T: 'a inference in structs</a></li></ol></li><li><a href="2018/transitioning/errors/index.html"><strong aria-hidden="true">3.1.5.</strong> Error Handling</a></li><li><ol class="section"><li><a href="2018/transitioning/errors/question-mark.html"><strong aria-hidden="true">3.1.5.1.</strong> ? in fn main() and #[test]s</a></li><li><a href="2018/transitioning/errors/try-throw-fail.html"><strong aria-hidden="true">3.1.5.2.</strong> try, throw, and fail</a></li></ol></li><li><a href="2018/transitioning/raw-identifiers.html"><strong aria-hidden="true">3.1.6.</strong> Raw identifiers</a></li></ol></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">The Rust Edition Guide</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="editions/transitioning.html#transitioning-your-code-to-a-new-edition" id="transitioning-your-code-to-a-new-edition"><h1>Transitioning your code to a new edition</h1></a>
<p>Transitioning between editions is built around lints. Fundamentally, the
process works like this:</p>
<ul>
<li>Get your code compiling with no warnings.</li>
<li>Opt in to the new edition.</li>
<li>Fix any new warnings that may result.</li>
</ul>
<p>Luckily, we've been working on a tool to help assist with this process,
<code>rustfix</code>. It can take suggestions from the compiler and automatically
re-write your code to comply with new features and idioms.</p>
<blockquote>
<p><code>rustfix</code> is still quite young, and very much a work in development. But it works
for the basics! We're working hard on making it better and more robust, but
please bear with us for now.</p>
</blockquote>
<a class="header" href="editions/transitioning.html#installing-rustfix" id="installing-rustfix"><h2>Installing rustfix</h2></a>
<p>You can get <code>rustfix</code> from GitHub, and eventually, <code>crates.io</code>. Given that you're probably using Cargo,
you'll want to run this:</p>
<pre><code class="language-shell">$ cargo install cargo-fix --git https://github.com/rust-lang-nursery/rustfix
</code></pre>
<p>And that's it!</p>
<a class="header" href="editions/transitioning.html#prepare-for-the-next-edition" id="prepare-for-the-next-edition"><h2>Prepare for the next edition</h2></a>
<p>Before we talk about how to move to the new edition, a reminder:</p>
<ul>
<li>New editions might change the way you write Rust -- they add syntax,
language, and library features but also remove others. For example,
<code>async</code>/<code>await</code> is available in Rust 2018, but not Rust 2015.</li>
<li>It's our intention that the migration to new editions is as smooth an experience
as possible. It's considered a bug if it's difficult to upgrade your crate to
a new edition. If you have a difficult time then a bug should be filed
with either rustfix or Rust itself.</li>
</ul>
<p>With that out of the way, let's get into it!</p>
<a class="header" href="editions/transitioning.html#the-preview-period" id="the-preview-period"><h3>The preview period</h3></a>
<p>First, editions have a &quot;preview&quot; phase. This lets you try out the new edition
in nightly Rust. During the preview, there's an extra step you need to take
to opt in. At the time of writing, Rust 2018 is in its preview phase.</p>
<p>To do that, add this feature flag to your <code>lib.rs</code> or <code>main.rs</code>:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#![feature(rust_2018_preview)]
#fn main() {
#}</code></pre></pre>
<p>This will ensure that you're enabling all of the relevant features. Note that
during the time the preview is available, we may continue to add/enable new
features with this flag!</p>
<a class="header" href="editions/transitioning.html#running-rustfix" id="running-rustfix"><h3>Running rustfix</h3></a>
<p>There are some lints that can help you prepare for the next edition, but
they're not currently turned on by default. <code>rustfix</code> has your back though!
To turn them on and have <code>rustfix</code> fix up your code, run this:</p>
<pre><code class="language-shell">$ cargo +nightly fix --prepare-for 2018
</code></pre>
<p>This would turn on those lints, and fix up the project for the 2018 edition.
If there's something that <code>rustfix</code> doesn't know how to fix automatically yet,
the usual compiler warning will be printed; you'll need to fix those
manually. Do so until you get a run with no warnings.</p>
<a class="header" href="editions/transitioning.html#commit-to-the-next-edition" id="commit-to-the-next-edition"><h2>Commit to the next edition</h2></a>
<p>Once you're happy with those changes, it's time to use the new edition.
Add this to your <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">cargo-features = [&quot;edition&quot;]

[package]
edition = '2018'
</code></pre>
<p>That <code>cargo-features</code> line should go at the very top; and <code>edition</code> goes into
the <code>[package]</code> section. As mentioned above, right now this is a nightly-only
feature of Cargo, so you need to enable it for things to work.</p>
<p>At this point, your project should compile with a regular old <code>cargo +nightly build</code>. However, since you've said you're using the new edition, you may get
more warnings! Time to bust out <code>rustfix</code> again.</p>
<a class="header" href="editions/transitioning.html#fix-new-warnings" id="fix-new-warnings"><h2>Fix new warnings</h2></a>
<p>To fix up these warnings, we can use <code>rustfix</code>:</p>
<pre><code class="language-shell">$ cargo +nightly fix
</code></pre>
<p>This will try to fix up all of the new warnings. Congrats! You're done!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="editions/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="2015/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="editions/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="2015/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
